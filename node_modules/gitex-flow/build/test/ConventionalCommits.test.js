"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
const chai_1 = require("chai");
const Utils_1 = require("../src/tools/Utils");
describe('Test ConventionCommits implementation', function () {
    it('should parse complex conventional commit messages', function () {
        return __awaiter(this, void 0, void 0, function* () {
            const logs = yield Utils_1.Utils.parseConventionalCommits([
                `fix(service): Removed support of unencrypted HTTP protocol
      
      This unencrypted protocol has led to several vulnerabilities in the framework.
      
      SECURITY: Only encrypted protocols are now allowed.
      REMOVED: Removed support for HTTP.
      BREAKING CHANGE: Removed HTTP endpoint in web service.
      
      closes #941, refs #1094, #1100`,
            ]);
            chai_1.assert.equal(logs[0].type, 'fix');
            chai_1.assert.equal(logs[0].scope, 'service');
            chai_1.assert.equal(logs[0].subject, 'Removed support of unencrypted HTTP protocol');
            chai_1.assert.isNull(logs[0].merge);
            chai_1.assert.deepStrictEqual(logs[0].notes, [
                {
                    title: 'SECURITY',
                    text: 'Only encrypted protocols are now allowed.',
                },
                {
                    title: 'REMOVED',
                    text: 'Removed support for HTTP.',
                },
                {
                    title: 'BREAKING CHANGE',
                    text: 'Removed HTTP endpoint in web service.\n      ',
                },
            ]);
            chai_1.assert.deepStrictEqual(logs[0].references, [
                {
                    action: 'closes',
                    owner: null,
                    repository: null,
                    issue: '941',
                    raw: '#941',
                    prefix: '#',
                },
                {
                    action: 'refs',
                    owner: null,
                    repository: null,
                    issue: '1094',
                    raw: '#1094',
                    prefix: '#',
                },
                {
                    action: 'refs',
                    owner: null,
                    repository: null,
                    issue: '1100',
                    raw: ', #1100',
                    prefix: '#',
                },
            ]);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29udmVudGlvbmFsQ29tbWl0cy50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vdGVzdC9Db252ZW50aW9uYWxDb21taXRzLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQSwrQkFBOEI7QUFDOUIsOENBQTJDO0FBRTNDLFFBQVEsQ0FBQyx1Q0FBdUMsRUFBRTtJQUNoRCxFQUFFLENBQUMsbURBQW1ELEVBQUU7O1lBQ3RELE1BQU0sSUFBSSxHQUFHLE1BQU0sYUFBSyxDQUFDLHdCQUF3QixDQUFDO2dCQUNoRDs7Ozs7Ozs7cUNBUStCO2FBQ2hDLENBQUMsQ0FBQztZQUVILGFBQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztZQUNsQyxhQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLENBQUM7WUFDdkMsYUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLDhDQUE4QyxDQUFDLENBQUM7WUFDOUUsYUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDN0IsYUFBTSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFO2dCQUNwQztvQkFDRSxLQUFLLEVBQUUsVUFBVTtvQkFDakIsSUFBSSxFQUFFLDJDQUEyQztpQkFDbEQ7Z0JBQ0Q7b0JBQ0UsS0FBSyxFQUFFLFNBQVM7b0JBQ2hCLElBQUksRUFBRSwyQkFBMkI7aUJBQ2xDO2dCQUNEO29CQUNFLEtBQUssRUFBRSxpQkFBaUI7b0JBQ3hCLElBQUksRUFBRSwrQ0FBK0M7aUJBQ3REO2FBQ0YsQ0FBQyxDQUFDO1lBQ0gsYUFBTSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFO2dCQUN6QztvQkFDRSxNQUFNLEVBQUUsUUFBUTtvQkFDaEIsS0FBSyxFQUFFLElBQUk7b0JBQ1gsVUFBVSxFQUFFLElBQUk7b0JBQ2hCLEtBQUssRUFBRSxLQUFLO29CQUNaLEdBQUcsRUFBRSxNQUFNO29CQUNYLE1BQU0sRUFBRSxHQUFHO2lCQUNaO2dCQUNEO29CQUNFLE1BQU0sRUFBRSxNQUFNO29CQUNkLEtBQUssRUFBRSxJQUFJO29CQUNYLFVBQVUsRUFBRSxJQUFJO29CQUNoQixLQUFLLEVBQUUsTUFBTTtvQkFDYixHQUFHLEVBQUUsT0FBTztvQkFDWixNQUFNLEVBQUUsR0FBRztpQkFDWjtnQkFDRDtvQkFDRSxNQUFNLEVBQUUsTUFBTTtvQkFDZCxLQUFLLEVBQUUsSUFBSTtvQkFDWCxVQUFVLEVBQUUsSUFBSTtvQkFDaEIsS0FBSyxFQUFFLE1BQU07b0JBQ2IsR0FBRyxFQUFFLFNBQVM7b0JBQ2QsTUFBTSxFQUFFLEdBQUc7aUJBQ1o7YUFDRixDQUFDLENBQUM7UUFDTCxDQUFDO0tBQUEsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMifQ==